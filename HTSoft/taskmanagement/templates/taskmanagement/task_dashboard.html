{% extends 'dashboard/base.html' %} {% load static %} {% block content %}
<!-- Page Heading -->

<div class="row">
  <div class="col">
    <a href="{% url 'ticketWeekList' %}" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"
    ><i class="fas fa-download fa-sm text-white-50"></i> Ticket tuần</a
  >
    <a href="{% url 'ticketList' %}" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"
    ><i class="fas fa-download fa-sm text-white-50"></i> Cảnh báo Assigned ticket</a
  >  
  </div>
</div>

<br>

<!-- Content Row -->
<div class="row">
  <!-- Build Doing Card Example -->
  <div class="col-xl-3 col-md-6 mb-4">
    <div class="card border-left-primary shadow h-100 py-2">
      <div class="card-body">
        <div class="row no-gutters align-items-center">
          <div class="col mr-2">
            <div
              class="text-xs font-weight-bold text-primary text-uppercase mb-1"
            >
              Build đang xây dựng
            </div>
            <div class="h5 mb-0 font-weight-bold text-gray-800">$40,000</div>
          </div>
          <div class="col-auto">
            <i class="fas fa-calendar fa-2x text-gray-300"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Build late Card Example -->
  <div class="col-xl-3 col-md-6 mb-4">
    <div class="card border-left-success shadow h-100 py-2">
      <div class="card-body">
        <div class="row no-gutters align-items-center">
          <div class="col mr-2">
            <div
              class="text-xs font-weight-bold text-success text-uppercase mb-1"
            >
              Build trễ tiến độ
            </div>
            <div class="h5 mb-0 font-weight-bold text-gray-800">$215,000</div>
          </div>
          <div class="col-auto">
            <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Build Done Card Example -->
  <div class="col-xl-3 col-md-6 mb-4">
    <div class="card border-left-info shadow h-100 py-2">
      <div class="card-body">
        <div class="row no-gutters align-items-center">
          <div class="col mr-2">
            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
              Build đã hoàn thành
            </div>
            <div class="row no-gutters align-items-center">
              <div class="col-auto">
                <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">
                  50%
                </div>
              </div>
              <div class="col">
                <div class="progress progress-sm mr-2">
                  <div
                    class="progress-bar bg-info"
                    role="progressbar"
                    style="width: 50%"
                    aria-valuenow="50"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-auto">
            <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Task late Card Example -->
  <div class="col-xl-3 col-md-6 mb-4">
    <div class="card border-left-warning shadow h-100 py-2">
      <div class="card-body">
        <div class="row no-gutters align-items-center">
          <div class="col mr-2">
            <div
              class="text-xs font-weight-bold text-warning text-uppercase mb-1"
            >
              Task trễ tiến độ
            </div>
            <div class="h5 mb-0 font-weight-bold text-gray-800">18</div>
          </div>
          <div class="col-auto">
            <i class="fas fa-comments fa-2x text-gray-300"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Tiến độ Task theo khách hàng Content Row -->
<div class="row">
  <!-- Content Column -->
  <div class="col-lg mb-6">
    <!-- Project Card Example -->
    <div class="card shadow mb-4">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">Projects</h6>
      </div>
      <div class="card-body">
        <h4 class="small font-weight-bold">
          Server Migration <span class="float-right">20%</span>
        </h4>
        <div class="progress mb-4">
          <div
            class="progress-bar bg-danger"
            role="progressbar"
            style="width: 20%"
            aria-valuenow="20"
            aria-valuemin="0"
            aria-valuemax="100"
          ></div>
        </div>
        <h4 class="small font-weight-bold">
          Sales Tracking <span class="float-right">40%</span>
        </h4>
        <div class="progress mb-4">
          <div
            class="progress-bar bg-warning"
            role="progressbar"
            style="width: 40%"
            aria-valuenow="40"
            aria-valuemin="0"
            aria-valuemax="100"
          ></div>
        </div>
        <h4 class="small font-weight-bold">
          Customer Database <span class="float-right">60%</span>
        </h4>
        <div class="progress mb-4">
          <div
            class="progress-bar"
            role="progressbar"
            style="width: 60%"
            aria-valuenow="60"
            aria-valuemin="0"
            aria-valuemax="100"
          ></div>
        </div>
        <h4 class="small font-weight-bold">
          Payout Details <span class="float-right">80%</span>
        </h4>
        <div class="progress mb-4">
          <div
            class="progress-bar bg-info"
            role="progressbar"
            style="width: 80%"
            aria-valuenow="80"
            aria-valuemin="0"
            aria-valuemax="100"
          ></div>
        </div>
        <h4 class="small font-weight-bold">
          Account Setup <span class="float-right">Complete!</span>
        </h4>
        <div class="progress">
          <div
            class="progress-bar bg-success"
            role="progressbar"
            style="width: 100%"
            aria-valuenow="100"
            aria-valuemin="0"
            aria-valuemax="100"
          ></div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg mb-6">
    <div class="card shadow mb-4">
      <!-- Card Header - Dropdown -->
      <div
        class="card-header py-3 d-flex flex-row align-items-center justify-content-between"
      >
        <h6 class="m-0 font-weight-bold text-primary">
          Tốc độ hoàn thành build
        </h6>
        <div class="dropdown no-arrow">
          <a
            class="dropdown-toggle"
            href="#"
            role="button"
            id="dropdownMenuLink"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
          >
            <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
          </a>
          <div
            class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
            aria-labelledby="dropdownMenuLink"
          >
            <div class="dropdown-header">Dropdown Header:</div>
            <a class="dropdown-item" href="#">Action</a>
            <a class="dropdown-item" href="#">Another action</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="#">Something else here</a>
          </div>
        </div>
      </div>
      <!-- Card Body -->
      <div class="card-body">
        <div class="chart-area">
          <canvas id="myAreaChart"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Content Row  Chart-->

<div class="row">
   <!-- Build List -->
  <div class="col-xl">
    <div class="card shadow mb-4">
      <!-- Card Header - Dropdown -->
      <div
        class="card-header py-3 d-flex flex-row align-items-center justify-content-between"
      >
        <div class="col-lg-4">
          <h6 class="m-0 font-weight-bold text-primary">Danh sách build</h6>
        </div>
      </div>
      <!-- Card Body -->
      <div class="card-body" >
        <div class="table-responsive">
          <table class="table table-bordered" id="dataTable">
            <thead>
              <tr>
                <th>BuildID</th>
                <th>BuildName</th>
                <th>DueDate</th>
                <th>Status</th>
                <th>ClientName</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="myTable">
              {% for build in builds %}
              <tr>
                <td>{{build.BuildID}}</td>
                <td>{{build.BuildName}}</td>
                <td>{{build.DueDate}}</td>
                <td>{{build.Status}}</td>
                <td>{{build.ClientName}}</td>
                <td>
                  <a type="button" class="btn btn-primary" href="{% url 'buildTickets' build.BuildID %}">
                    <i class="far fa-eye"></i>
                  </a>
                  <a
                    href="javascript:void(0)"
                    data-toggle="modal"
                    class="edit-view-modal btn btn-success"
                    data-url="#"
                    data-target="#modalCart"
                    data-message=""
                  >
                    <i class="fas fa-edit"></i>
                  </a>
                  <a
                    href="javascript:void(0)"
                    data-toggle="modal"
                    class="confirm-delete btn btn-danger"
                    data-url="#"
                    data-target="#deleteItemModal"
                    data-message="Bạn có chắc muốn xóa {{build.BuildName}}?"
                  >
                    <i class="far fa-trash-alt"></i>
                  </a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>




<!-- Modal Edit -->
<div
  class="modal fade"
  id="modalCart"
  tabindex="-1"
  role="dialog"
  aria-labelledby="editItemModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Edit Build Form</h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body confirm-delete">
        <div id="modal-message"></div>

        <div class="form-group">
          <label class="form-label"><b>Build Name</b></label>
          <input type="text" class="form-control" name=""/>
        </div>

        <div class="form-group">
          <label class="form-label"><b>Build Customer</b></label>
          <select class="form-control" aria-label="Default select example">
            <option selected>Open this select menu</option>
            <option value="1">One</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label"><b>Build Status</b></label>
          <select class="form-control" aria-label="Default select example">
            <option selected>Open this select menu</option>
            <option value="1">One</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label"><b>Deadline</b></label>
          <input type="text" class="form-control" />
        </div>
      </div>
      <!--Footer-->
      <div class="modal-footer">
        <form method="POST" action="" id="form_edit_modal">
          {% csrf_token %}
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            Close
          </button>
          <button
            type="button"
            class="btn btn-primary"
            data-dismiss="modal"
            id="confirmButtonModal"
          >
            Update
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
<!-- Modal: modalCart -->

<!-- Modal Delete -->
<div
  class="modal fade"
  id="deleteItemModal"
  tabindex="-1"
  role="dialog"
  aria-labelledby="deleteItemModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Delete confirm</h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body confirm-delete text-center">
        <div id="modal-message"></div>
      </div>
      <div class="modal-footer">
        <form method="POST" action="" id="form_confirm_modal">
          {% csrf_token %}
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            Close
          </button>
          <button
            type="button"
            class="btn btn-danger"
            data-dismiss="modal"
            id="confirmButtonModal"
          >
            Delete
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", () => {
    let form_confirm = document.querySelector("#form_confirm_modal");
    let buttons = document.querySelectorAll("[data-target='#deleteItemModal']");
    buttons.forEach((button) => {
      button.addEventListener("click", () => {
        // extract texts from calling element and replace the modals texts with it
        if (button.dataset.message) {
          document.getElementById("modal-message").innerHTML =
            button.dataset.message;
        }
        // extract url from calling element and replace the modals texts with it
        if (button.dataset.url) {
          form_confirm.action = button.dataset.url;
        }
      });
    });
    let confirmModal = document.getElementById("confirmButtonModal");
    confirmModal.addEventListener("click", () => {
      form_confirm.submit();
    });
  });
</script>
{% endblock %}
